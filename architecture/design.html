

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Discovery system and frontend design &mdash; GSA Discovery 3.0.1 documentation</title>
  

  
  
  
  

  

  
  
    

  

  <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Discovery data" href="data.html" />
    <link rel="prev" title="Discovery technologies" href="technologies.html" /> 

  
  <script src="../_static/js/modernizr.min.js"></script>

</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search">
          

          
            <a href="../index.html" class="icon icon-home"> GSA Discovery
          

          
            
            <img src="../_static/discovery.png" class="logo" alt="Logo"/>
          
          </a>

          
            
            
              <div class="version">
                3.0.1
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <ul class="current">
<li class="toctree-l1 current"><a class="reference internal" href="../readme.html">Discovery overview</a><ul class="current">
<li class="toctree-l2 current"><a class="reference internal" href="../readme.html#documentation-outline">Documentation outline</a><ul class="current">
<li class="toctree-l3"><a class="reference internal" href="../readme.html#getting-set-up-with-discovery">Getting set up with Discovery</a></li>
<li class="toctree-l3 current"><a class="reference internal" href="../readme.html#discovery-architecture-and-design">Discovery architecture and design</a><ul class="current">
<li class="toctree-l4"><a class="reference internal" href="technologies.html">Technologies required</a></li>
<li class="toctree-l4 current"><a class="current reference internal" href="#">Application system and interface design</a></li>
<li class="toctree-l4"><a class="reference internal" href="data.html">Discovery data</a></li>
<li class="toctree-l4"><a class="reference internal" href="assets.html">Static assets</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../readme.html#discovery-related-processes">Discovery related processes</a></li>
<li class="toctree-l3"><a class="reference internal" href="../readme.html#useful-links">Useful links</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../readme.html#related-projects">Related projects</a></li>
</ul>
</li>
</ul>
<p class="caption"><span class="caption-text">Links</span></p>
<ul>
<li class="toctree-l1"><a class="reference external" href="https://discovery.gsa.gov/">Discovery live</a></li>
<li class="toctree-l1"><a class="reference external" href="https://discovery-dev.app.cloud.gov/">Discovery development</a></li>
<li class="toctree-l1"><a class="reference external" href="https://github.com/PSHCDevOps/discovery/">GitHub project</a></li>
<li class="toctree-l1"><a class="reference external" href="https://trello.com/b/AEoWtET7/discovery-20/">Trello board</a></li>
</ul>
<p class="caption"><span class="caption-text">Getting Started</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../start/readme.html">Getting started with Discovery</a></li>
<li class="toctree-l1"><a class="reference internal" href="../start/about.html">About Discovery</a></li>
<li class="toctree-l1"><a class="reference internal" href="../start/development.html">Discovery development options</a></li>
<li class="toctree-l1"><a class="reference internal" href="../start/vagrant.html">Discovery on Vagrant</a></li>
<li class="toctree-l1"><a class="reference internal" href="../start/docker.html">Discovery on Docker</a></li>
<li class="toctree-l1"><a class="reference internal" href="../start/setup.html">Discovery setup</a></li>
</ul>
<p class="caption"><span class="caption-text">Architecture</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="readme.html">Architecture and design</a></li>
<li class="toctree-l1"><a class="reference internal" href="technologies.html">Discovery technologies</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">Discovery system and frontend design</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#overview">Overview</a></li>
<li class="toctree-l2"><a class="reference internal" href="#configuration">Configuration</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#local-docker-configuration">Local Docker configuration</a></li>
<li class="toctree-l3"><a class="reference internal" href="#circleci-configuration">CircleCI configuration</a></li>
<li class="toctree-l3"><a class="reference internal" href="#cloud-gov-configuration">Cloud.gov configuration</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#api">API</a></li>
<li class="toctree-l2"><a class="reference internal" href="#website">Website</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#django-views-and-templates">Django views and templates</a></li>
<li class="toctree-l3"><a class="reference internal" href="#jquery-based-javascript-application">Jquery based Javascript application</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#scheduler-and-worker-processes">Scheduler and worker processes</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#scheduling">Scheduling</a></li>
<li class="toctree-l3"><a class="reference internal" href="#task-processing">Task processing</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="data.html">Discovery data</a></li>
<li class="toctree-l1"><a class="reference internal" href="assets.html">Discovery static assets</a></li>
</ul>
<p class="caption"><span class="caption-text">Processes</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../process/readme.html">Discovery processes</a></li>
<li class="toctree-l1"><a class="reference internal" href="../process/development.html">Discovery development process</a></li>
<li class="toctree-l1"><a class="reference internal" href="../process/testing.html">Discovery testing process</a></li>
<li class="toctree-l1"><a class="reference internal" href="../process/deployment.html">Discovery deployment process</a></li>
<li class="toctree-l1"><a class="reference internal" href="../process/management.html">Discovery management</a></li>
<li class="toctree-l1"><a class="reference internal" href="../process/contributing.html">Contributing to Discovery</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">GSA Discovery</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../index.html">Docs</a> &raquo;</li>
        
          <li><a href="../readme.html">Discovery overview</a> &raquo;</li>
        
      <li>Discovery system and frontend design</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="discovery-system-and-frontend-design">
<span id="discovery-system-and-frontend-design"></span><h1>Discovery system and frontend design<a class="headerlink" href="#discovery-system-and-frontend-design" title="Permalink to this headline">¶</a></h1>
<p><strong>&lt;</strong> <a class="reference internal" href="technologies.html"><span class="doc">Technologies Required</span></a> | <strong>^</strong> <strong><a class="reference internal" href="readme.html"><span class="doc">Architecture Overview</span></a></strong> | <a class="reference internal" href="data.html"><span class="doc">Application Data</span></a> <strong>&gt;</strong></p>
<p><br/></p>
<div class="section" id="overview">
<span id="overview"></span><h2>Overview<a class="headerlink" href="#overview" title="Permalink to this headline">¶</a></h2>
<p>The Discovery application system is built with a layered architecture of components, acccesses data from potentially diverse sources, and provides an ideally easy to use filtered search system to users looking for help during the market research phase of the acquisition lifecycle.</p>
<p>For a high level overview of the system architecture at the container and service level the following diagram depicts a Cloud.gov hosting environment and the data flow between high level components.</p>
<p><img alt="Discovery architecture" src="../_images/Discovery-DataFlow-Users.png" /></p>
<p>This document will review some of the internal architectural components within the above system instances.</p>
<p><br/></p>
</div>
<div class="section" id="configuration">
<span id="configuration"></span><h2>Configuration<a class="headerlink" href="#configuration" title="Permalink to this headline">¶</a></h2>
<p>All configurations in the Discovery applications <em>(website, worker, and scheduler)</em> are passed as environment variables to the container to follow the <a class="reference external" href="https://12factor.net/config">twelve factor application model</a>.  This allows us to easily work between local Docker environment, CI/CD environment, and our remote hosting environments.</p>
<p>For a list of application specific environment variables that must be set for the application to function properly, see the <a class="reference internal" href="../start/docker.html"><span class="doc">Docker getting started documentation</span></a>.</p>
<div class="section" id="local-docker-configuration">
<span id="local-docker-configuration"></span><h3>Local Docker configuration<a class="headerlink" href="#local-docker-configuration" title="Permalink to this headline">¶</a></h3>
<p>The local Docker configuration is passed to running Django containers from an included <strong>docker-compose.base.yml</strong> file in the <strong>docker</strong> directory.  These configurations are merged with local private configurations to provide a fully configured Discovery application runtime environment <em>(See <a class="reference internal" href="../start/docker.html"><span class="doc">Docker getting started</span></a> for more details)</em></p>
</div>
<div class="section" id="circleci-configuration">
<span id="circleci-configuration"></span><h3>CircleCI configuration<a class="headerlink" href="#circleci-configuration" title="Permalink to this headline">¶</a></h3>
<p>The PSHC CircleCI organization has a managed Discovery project that executes the CircleCI configuration in the <strong>.circleci</strong> directory.  This configuration defines some configuration parameters, which are then mixed with secure project defined environment variables and injected into the running application containers.</p>
<p>The CircleCI project requires all variables defined in the <strong>docker/django-env.example.vars</strong> file to be defined in the CircleCI environment interface.</p>
<p>It is also important when configuring CircleCI to deploy to a Cloud.gov environment that the proper credential variables are defined.  See the <strong>deploy-dev.sh</strong> and <strong>deploy-prod.sh</strong> scripts for these variables.  All container based jobs must share the same environment defined in the project interface, so we prefix the credentials with <strong>DEV</strong> or <strong>PROD</strong>.  The variables that must be set include;</p>
<ul class="simple">
<li>(DEV/PROD)_SERVICE_ORG</li>
<li>(DEV/PROD)_SERVICE_SPACE</li>
<li>(DEV/PROD)_SERVICE_ACCOUNT</li>
<li>(DEV/PROD)_SERVICE_ACCOUNT_PASSWORD</li>
</ul>
<p>All deployments from CircleCI to Cloud.gov require a service account and key that is active in a single Cloud Foundry space.</p>
</div>
<div class="section" id="cloud-gov-configuration">
<span id="cloud-gov-configuration"></span><h3>Cloud.gov configuration<a class="headerlink" href="#cloud-gov-configuration" title="Permalink to this headline">¶</a></h3>
<p>The Discovery application uses shared custom user provided service instances that define the environment variables listed in <strong>docker/django-env.example.vars</strong>.  These are then bound to all Django applications <em>(web, scheduler, workers)</em>.</p>
<p>This environment can be set up with the <strong>scripts/setup-cf-space.sh &#8211;help</strong> command.  See the command help information and source code for more information.</p>
<p>All service credentials, including our application centric environment variables, are passed via the <strong>VCAP_SERVICES</strong> environment variable to the running application containers.</p>
<p><br/></p>
</div>
</div>
<div class="section" id="api">
<span id="api"></span><h2>API<a class="headerlink" href="#api" title="Permalink to this headline">¶</a></h2>
<p>The core of the Discovery application is a simple API that serves up vendor, contract, and various other metadata relating to those data types.  This is defined as a RESTful interface with endpoints at http://localhost:8080/api.</p>
<p>For more information on the available endpoints see http://localhost:8080/docs.</p>
<p><br/></p>
</div>
<div class="section" id="website">
<span id="website"></span><h2>Website<a class="headerlink" href="#website" title="Permalink to this headline">¶</a></h2>
<p>The Discovery frontend interface is a filtered search of vendor and contract information pertaining to included Discovery vehicles.  All of the data that is served up to the frontend is available via the APIs discussed above.  The gateway to the website is: http://localhost:8080/ <em>(which should display a filter and overview information)</em></p>
<div class="section" id="django-views-and-templates">
<span id="django-views-and-templates"></span><h3>Django views and templates<a class="headerlink" href="#django-views-and-templates" title="Permalink to this headline">¶</a></h3>
<p>The foundation of the Discovery interface are custom views that render templates that are scaffolding that gets filled out by frontend Javascript after initial page load.</p>
</div>
<div class="section" id="jquery-based-javascript-application">
<span id="jquery-based-javascript-application"></span><h3>Jquery based Javascript application<a class="headerlink" href="#jquery-based-javascript-application" title="Permalink to this headline">¶</a></h3>
<p>Most of the data you see rendered on the Discovery web page during the search process is rendered by an <a class="reference external" href="https://angularjs.org/">Angular JS</a> application that accesses the backend Django Discovery API and provides a single page app experience to site users built with the <a class="reference external" href="https://designsystem.digital.gov/">US Web Design System</a>.</p>
<p>The Django application passes a single environment variable through to the client side Javascript; <strong>API_HOST</strong>.</p>
<ul class="simple">
<li><strong>API_HOST</strong> - Full host of the discovery site providing the API <em>(e.g, http://localhost:8080)</em></li>
</ul>
<p><br/></p>
</div>
</div>
<div class="section" id="scheduler-and-worker-processes">
<span id="scheduler-and-worker-processes"></span><h2>Scheduler and worker processes<a class="headerlink" href="#scheduler-and-worker-processes" title="Permalink to this headline">¶</a></h2>
<p>Continuously running in the background are internal servers continuously scheduling and processing tasks, which right now are just data updaters.</p>
<div class="section" id="scheduling">
<span id="scheduling"></span><h3>Scheduling<a class="headerlink" href="#scheduling" title="Permalink to this headline">¶</a></h3>
<p>The Celery Beat scheduler <em>(see <a class="reference internal" href="technologies.html"><span class="doc">Discovery technologies</span></a>)</em> runs as a single application instance that checks for updates from the administrative scheduling interface and send tasks to the task processors via a Redis queue.</p>
<p>There should only ever be a single scheduler operating in an application space, as the schedulers might conflict and duplicate jobs.</p>
<p>We also initialize and run database updates on deployment of the scheduler, which prevents race conditions during migrations that can occur if we update the database on deployment of clustered web servers.</p>
</div>
<div class="section" id="task-processing">
<span id="task-processing"></span><h3>Task processing<a class="headerlink" href="#task-processing" title="Permalink to this headline">¶</a></h3>
<p>Celery based task processors <em>(at least one)</em> are constantly checking the Redis task queue and running the appropriate task.  Task results are then reported back to the Discovery application through the PostgreSQL database.</p>
<p>Each task is a wrapper with special logic around a defined Django command.  The task provides a Celery registration, mutex lock, and output collection for reporting purposes.</p>
<p>There are currently only data update and cache population tasks defined in the system, but this will most likely expand in the future.</p>
<p><br/></p>
</div>
</div>
</div>


           </div>
           
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="data.html" class="btn btn-neutral float-right" title="Discovery data" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="technologies.html" class="btn btn-neutral" title="Discovery technologies" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2017, GSA Federal Acquisition Service

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  

    
    
      <script type="text/javascript">
          var DOCUMENTATION_OPTIONS = {
              URL_ROOT:'../',
              VERSION:'3.0.1',
              LANGUAGE:'None',
              COLLAPSE_INDEX:false,
              FILE_SUFFIX:'.html',
              HAS_SOURCE:  true,
              SOURCELINK_SUFFIX: '.txt'
          };
      </script>
        <script type="text/javascript" src="../_static/jquery.js"></script>
        <script type="text/javascript" src="../_static/underscore.js"></script>
        <script type="text/javascript" src="../_static/doctools.js"></script>
    

  

  <script type="text/javascript" src="../_static/js/theme.js"></script>

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>